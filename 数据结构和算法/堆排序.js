function heap(array) {
    checkArray(array);
    // 将最大值交换到首位
    for (let i = 0; i < array.length; i++) {
      heapInsert(array, i);
    }
    let size = array.length;
    // 交换首位和末尾
    swap(array, 0, --size);
    while (size > 0) {
      heapify(array, 0, size);
      swap(array, 0, --size);
    }
    return array;
  }
  
  function heapInsert(array, index) {
    // 如果当前节点比父节点大，就交换
    while (array[index] > array[parseInt((index - 1) / 2)]) {
      swap(array, index, parseInt((index - 1) / 2));
      // 将索引变成父节点
      index = parseInt((index - 1) / 2);
    }
  }
  function heapify(array, index, size) {
    let left = index * 2 + 1;
    while (left < size) {
      // 判断左右节点大小
      let largest =
        left + 1 < size && array[left] < array[left + 1] ? left + 1 : left;
      // 判断子节点和父节点大小
      largest = array[index] < array[largest] ? largest : index;
      if (largest === index) break;
      swap(array, index, largest);
      index = largest;
      left = index * 2 + 1;
    }
  }